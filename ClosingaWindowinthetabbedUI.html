

<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="HelpNDoc Professional Edition 7.3.0.348">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="favicon.ico"/>

  <title>Closing a Window in the tabbed UI</title>
  <meta name="description" content="" /> 
  <meta name="keywords" content="">



  

  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Closing a Window in the tabbed UI">
  <meta name="twitter:description" content="">

  <!-- Open Graph data -->
  <meta property="og:title" content="Closing a Window in the tabbed UI" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="alpha360 v3.3 - 351 documentation " /> 

  <!-- Bootstrap core CSS -->
  <link href="vendors/bootstrap-3.4.1/css/bootstrap.min.css" rel="stylesheet"/>

  <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
  <link href="vendors/bootstrap-3.4.1/css/ie10-viewport-bug-workaround.css" rel="stylesheet"/>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="vendors/html5shiv-3.7.3/html5shiv.min.js"></script>
      <script src="vendors/respond-1.4.2/respond.min.js"></script>
    <![endif]-->

  <!-- JsTree styles -->
  <link href="vendors/jstree-3.3.10/themes/default/style.min.css" rel="stylesheet"/>

  <!-- Hnd styles -->
  <link href="css/layout.min.css" rel="stylesheet" />
  <link href="css/effects.min.css" rel="stylesheet" />
  <link href="css/theme-light-blue.min.css" rel="stylesheet" />
  <link href="css/print.min.css" rel="stylesheet" media="print" />
  <style type="text/css">nav { width: 350px} @media screen and (min-width:769px) { body.md-nav-expanded div#main { margin-left: 350px} body.md-nav-expanded header { padding-left: 364px} }</style>

  <!-- Content style -->
  <link href="css/hnd.content.css" rel="stylesheet" />

  



</head>

<body class="md-nav-expanded">



  <div id="skip-link">
    <a href="#main-content" class="element-invisible">Skip to main content</a>
  </div>

  <header class="headroom">
    <button class="hnd-toggle btn btn-default">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>        
    </button>
    <h1>alpha360 v3.3 - 351 documentation </h1>
    
  </header>

  <nav id="panel-left" class="md-nav-expanded">
    <!-- Nav tabs -->
    <ul class="tab-tabs nav nav-tabs" role="tablist">
      <li id="nav-close"> 
        <button class="hnd-toggle btn btn-default">
          <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
      </li>
      
	  
        <li role="presentation" class="tab active">
            <a href="#contents" id="tab-contents" aria-controls="contents" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-list"></i>
                Contents
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#index" id="tab-index" aria-controls="index" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-asterisk"></i>
                Index
            </a>
        </li>
      
        <li role="presentation" class="tab">
            <a href="#search" id="tab-search" aria-controls="search" role="tab" data-toggle="tab">
                <i class="glyphicon glyphicon-search"></i>
                Search
            </a>
        </li>
      
    </ul>  <!-- /Nav tabs -->

    <!-- Tab panes -->
    <div class="tab-content">
	  
      <div role="tabpanel" class="tab-pane active" id="contents">
        <div id="toc" class="tree-container unselectable"
            data-url="_toc.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /contents-->
      
      <div role="tabpanel" class="tab-pane" id="index">
        <div id="keywords" class="tree-container unselectable"
            data-url="_keywords.json"
            data-openlvl="1"
        >
            
        </div>
      </div>  <!-- /index-->
      
      <div role="tabpanel" class="tab-pane" id="search">
        <div class="search-content">
          <div class="search-input">
            <form id="search-form">
              <div class="form-group">
                <div class="input-group">
                  <input type="text" class="form-control" id="input-search" name="input-search" placeholder="Search..." />
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit">
                      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                    </button>
                  </span>
                </div>
              </div>
            </form>
          </div>  <!-- /search-input -->
          <div class="search-result">
            <div id="search-info"></div>
            <div class="tree-container unselectable" id="search-tree"></div>
          </div>  <!-- /search-result -->
        </div>  <!-- /search-content -->
      </div>  <!-- /search-->
      
    </div>  <!-- /Tab panes -->

  </nav>

  <div id="main">

    <article>
        <div id="topic-content" class="container-fluid" 
		  data-hnd-id="ClosingaWindowinthetabbedUI"
		  data-hnd-context="40"
		  data-hnd-title="Closing a Window in the tabbed UI"
		>
            
                <div class="navigation">
                    <ol class="breadcrumb">
                        <li><a href="alpha360BusinessApplicationsWLve.html">alpha360 Business Applications [WL versions]</a></li><li><a href="MicrosoftWindowsversions.html">Microsoft Windows versions</a></li><li><a href="thetabbedUI.html">the tabbed UI</a></li>
                    </ol>
                    <div class="nav-arrows">
                        <div class="btn-group btn-group" role="group"><a class="btn btn-default" href="thetabbedUI.html" title="the tabbed UI" role="button"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span></a><a class="btn btn-default" href="OpeningaWindowinthetabbedUI.html" title="Opening a Window in the tabbed UI" role="button"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span></a><a class="btn btn-default" href="UsingthetabbedUI.html" title="Using the tabbed UI" role="button"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span></a></div>
                    </div>
                </div> 
            

            <a id="main-content"></a>

            <h2>Closing a Window in the tabbed UI</h2>

            <div class="main-content">
                
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2"><span class="rvts11">The "classic" way to close a simple window with WINDEV is to use&nbsp;</span><span class="rvts31">Close(WindowName, Returned value1)</span><span class="rvts11">&nbsp;etc ...</span></p>
<p class="rvps2"><span class="rvts11">But with internal windows, embedded inside Dynamic TABs, this does not work anymore.</span></p>
<p class="rvps2"><span class="rvts11">You can find more information in PCSoft's help, about the right way to do it, but it will take you some time to understand it and clear up the "little but important" details.</span></p>
<p class="rvps2"><span class="rvts11">​</span></p>
<p class="rvps2"><span class="rvts11">The&nbsp;</span><span class="rvts31">a360_CloseWindow()&nbsp;</span><span class="rvts11">procedure, takes care of all these "closing issues" in a simple and elegant way.&nbsp;</span></p>
<p class="rvps2"><span class="rvts11">Just use the following code, inside your internal windows:</span></p>
<p class="rvps2"><span class="rvts11">​</span></p>
<p class="rvps2"><span class="rvts31">// Remove the Internal Window from the DynamicTAB</span><br/><span class="rvts31">a360_CloseWindow(p_OpenWindow.sDynamicInternalWindowKey,...</span></p>
<p class="rvps2"><span class="rvts31">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p_OpenWindow.sDynamicInternalWindowID, ...</span></p>
<p class="rvps2"><span class="rvts31">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p_OpenWindow.sReturnTOWindow,...</span></p>
<p class="rvps2"><span class="rvts23">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span class="rvts31">&nbsp;sReturnThis)</span></p>
<p class="rvps2"><span class="rvts11">​</span></p>
<p class="rvps2"><span class="rvts11">In the alpha360 projects, this code is always in a procedure, local to the internal window, and named&nbsp;</span><span class="rvts31">UI_Close</span><span class="rvts11">.</span></p>
<p class="rvps2"><span class="rvts11">Here is a short explanation of the variables used in the above procedure:</span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 28px; list-style-position: outside; list-style-type: disc;">
 <li class="rvps2"><span class="rvts31">.sDynamicInternalWindowKey and&nbsp;.sDynamicInternalWindowID&nbsp;</span><span class="rvts11">come from the structure we passed when "opening the window" and are automatically constructed and handled by the UI.</span></li>
 <li class="rvps2"><span class="rvts11">.</span><span class="rvts31">sReturnTOWindow -&nbsp;</span><span class="rvts11">if used, tells the UI to which "internal window" it must "try" to give focus after "closing" the "window".&nbsp;</span></li>
</ul>
<p class="rvps6"><span class="rvts11">We say "try", because this "internal window" may have been closed by the user.</span></p>
<ul style="text-indent: 0px; padding: 0; margin: 0 0 0 28px; list-style-position: outside; list-style-type: disc;">
 <li class="rvps2"><span class="rvts11">.</span><span class="rvts31">sReturnThis -</span><span class="rvts11">&nbsp;this value is "returned" to the above sReturnTOWindow&nbsp;and the variable must be declared in the Global Area of each internal window.&nbsp;</span></li>
</ul>
<p class="rvps2"><span class="rvts23">&nbsp;</span></p>
<p class="rvps2"><span class="rvts11">Note: When returning or giving focus to another "embedded internal window" the UI tries to run a local procedure named UI_RefreshRequest and pass to it the&nbsp;.</span><span class="rvts31">sReturnThis&nbsp;</span><span class="rvts11">variable.</span></p>
<p class="rvps2"><span class="rvts11">We can use this variable to automatically select an entry in a table - see the code in UI_RefreshRequest() of the IWB_Products window.&nbsp;</span></p>
<p class="rvps2"><span class="rvts11"><br/></span></p>
<p class="rvps2" style="page-break-before: always;"><span class="rvts11"></span><span class="rvts6"></span></p>

            </div>
            
            <div id="topic_footer"><div id="topic_footer_content">Copyright &copy; 2023 by computerplus. All Rights Reserved.</div></div>
        </div>  <!-- /#topic-content -->
    </article>

    <footer></footer>

  </div>  <!-- /#main -->

  <div class="mask" data-toggle="sm-nav-expanded"></div>
  
  <!-- Modal -->
  <div class="modal fade" id="hndModal" tabindex="-1" role="dialog" aria-labelledby="hndModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="hndModalLabel"></h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary modal-btn-close" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Splitter -->
  <div id="hnd-splitter" style="left: 350px"></div>  

  <!-- Scripts -->
  <script src="vendors/jquery-3.5.1/jquery.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  <script src="vendors/bootstrap-3.4.1/js/ie10-viewport-bug-workaround.js"></script>
  <script src="vendors/markjs-8.11.1/jquery.mark.min.js"></script>
  <script src="vendors/uri-1.19.2/uri.min.js"></script>
  <script src="vendors/imageMapResizer-1.0.10/imageMapResizer.min.js"></script>
  <script src="vendors/headroom-0.11.0/headroom.min.js"></script>
  <script src="vendors/jstree-3.3.10/jstree.min.js"></script>  
  <script src="vendors/interactjs-1.9.22/interact.min.js"></script>  

  <!-- HelpNDoc scripts -->
  <script src="js/polyfill.object.min.js"></script>
  <script src="_translations.js"></script>
  <script src="js/hndsd.min.js"></script>
  <script src="js/hndse.min.js"></script>
  <script src="js/app.min.js"></script>

  <!-- Init script -->
  <script>
    $(function() {
      // Create the app
      var app = new Hnd.App();
      // Update translations
      hnd_ut(app);
	  // Instanciate imageMapResizer
	  imageMapResize();
	  // Custom JS
	  
      // Boot the app
      app.Boot();
    });
  </script>



</body>

</html>

